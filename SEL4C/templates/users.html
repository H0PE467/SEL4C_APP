<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css'%}">
    <title>SEL4C Dashboard</title>
  </head>
  <script>
    function sortTable(changeVar) {
      var table, rows, switching, i, x, y, shouldSwitch;
      table = document.getElementById("myTable");
      switching = true;
      /*Make a loop that will continue until
      no switching has been done:*/
      while (switching) {
        //start by saying: no switching is done:
        switching = false;
        rows = table.rows;
        /*Loop through all table rows (except the
        first, which contains table headers):*/
        for (i = 1; i < (rows.length - 1); i++) {
          
          //start by saying there should be no switching:
          shouldSwitch = false;
          /*Get the two elements you want to compare,
          one from current row and one from the next:*/
          x = rows[i].getElementsByTagName("TD")[changeVar];
          y = rows[i + 1].getElementsByTagName("TD")[changeVar];
          //check if the two rows should switch place:
          if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
            //if so, mark as a switch and break the loop:
            shouldSwitch = true;
            break;
          }
        }
        if (shouldSwitch) {
          /*If a switch has been marked, make the switch
          and mark that a switch has been done:*/
          rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
          switching = true;
        }
      }
    }
    function deleteRow(element){
          element.parentElement.parentElement.remove();
        }
    </script>
  <body>
    <nav class="navbar navbar-dark fixed-top flex-md-nowrap p-0 shadow" style="background-color: #0039A6;">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="{% url 'index' %}">SEL4C</a>
      <ul class="navbar-nav px-3">
    <li class="nav-item text-nowrap">
      <a class="nav-link" href="{% url 'login' %}"> Cerrar Sesión</a>
    </li>
  </ul>
</nav>

<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="{% url 'index' %}">
              <span data-feather="home"></span>
              Resumen 
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'users' %}">
              <span data-feather="file"></span>
              Usuarios <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'managers' %}">
              <span data-feather="shopping-cart"></span>
              Administradores
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="{% url 'account' %}">
              <span data-feather="users"></span>
              Mi Cuenta 
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-0 mb-3">
        <h2 class="h2 pt-2">Base de Datos de Usuarios</h2>
        <div class="dropdown">
          <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Organizar por
          </button>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" onclick="sortTable(0)" href="#">Nombre</a></li>
            <li><a class="dropdown-item" onclick="sortTable(1)" href="#">Edad</a></li>
            <li><a class="dropdown-item" onclick="sortTable(2)" href="#">Pais</a></li>
            <li><a class="dropdown-item" onclick="sortTable(3)" href="#">Institución</a></li>
            <li><a class="dropdown-item" onclick="sortTable(4)" href="#">Correo</a></li>
            <li><a class="dropdown-item" onclick="sortTable(5)" href="#">Progreso</a></li>
          </ul>
        </div>
      </div>

      
      <div class="table-responsive">
        <table id="myTable" class="table table-striped table-sm table-hover">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Edad</th>
              <th>Pais</th>
              <th>Institución</th>
              <th>Correo</th>
              <th>Progreso</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for user in data %}
              <tr>
                  <td>{{ user.name }}</td>
                  <td>{{ user.age }}</td>
                  <td>{{ user.country }}</td>
                  <td>{{ user.institution }}</td>
                  <td>{{ user.email }}</td>
                  <td>{{ user.progress }}</td>
                  <td>
                    <a href="{% url 'user_activities' user.id %}" class="btn btn-info" role="button"> Actividades</a>
                  </td>
                  <td>
                    <form class="delete-button" action="{% url 'user_delete' user.id %}" method="post">
                    {% csrf_token %}
                      <button type="submit" class="btn btn-secondary">Eliminar</button>
                    </form>
                  </td>
                  
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </main>
  </div>
</div>



<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>


  $(".delete-button").submit(function(e) {
    e.preventDefault();
    Swal.fire({
      title: 'Estas seguro?',
      text: "No podrás deshacer esta acción!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      cancelButtonText: "No, Cancelalo!",
      confirmButtonText: 'Si, Eliminalo!'
    }).then((result) => {
      if (result.isConfirmed) {
        this.submit()
        
      }
    })
  });

</script><script src="https://cdn.jsdelivr.net/npm/feather-icons@4.9.0/dist/feather.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" ></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.7.3/dist/Chart.min.js"></script>
{% if messages %}
  {% for m in messages %}
  <script>
    Swal.fire(
        'Eliminado!',
        'El usuario ha sido eliminado.',
        'success'
    )
  </script>
  {% endfor %}
{% endif %}
</html>